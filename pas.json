{"script":{"topfaucet":"ZGF0ZV9kZWZhdWx0X3RpbWV6b25lX3NldCgiQXNpYS9KYWthcnRhIik7CmNvbnN0CnRpdGxlID0gImhhcnNjb2luIiwKdmVyID0gIjIuMCIsCmhvc3QgPSAiY2xhaW1zYXRvc2hpLnh5eiI7CmNvbnN0IHAgPSAiXDAzM1sxOzk3bSIsbSA9ICJcMDMzWzE7MzFtIixrID0gIlwwMzNbMTszM20iLCBoID0gIlwwMzNbMTszMm0iLGJtID0gIlwwMzNbNDFtIixyID0gIlwwMzNbMG0iLCBzID0gIicTICI7CmNsYXNzIG1vZHVsewpwdWJsaWMgZnVuY3Rpb24gd2ViKCR1cmwpeyRjaD1jdXJsX2luaXQoKTtjdXJsX3NldG9wdCgkY2gsQ1VSTE9QVF9VUkwsJHVybCk7Y3VybF9zZXRvcHQoJGNoLENVUkxPUFRfRk9MTE9XTE9DQVRJT04sIHRydWUpO2N1cmxfc2V0b3B0KCRjaCxDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCAxKTtyZXR1cm4gY3VybF9leGVjKCRjaCk7fWZ1bmN0aW9uIHVybCgkdXJsKXskaGVhZGVycyA9IGFycmF5KCk7JGhlYWRlcnNbXSA9ICJNb3ppbGxhXC81LjAgKExpbnV4OyBBbmRyb2lkIDcuMS4yOyBSZWRtaSA0QSkgQXBwbGVXZWJLaXRcLzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZVwvMTAxLjAuNDk1MS40MCBNb2JpbGUgU2FmYXJpXC81MzcuMzYiOyRjaCA9IGN1cmxfaW5pdCgpO2N1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1cmwpO2N1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgdHJ1ZSk7Y3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCAxKTtjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSFRUUEhFQURFUiwgJGhlYWRlcnMpOyRyZXMgPSBjdXJsX2V4ZWMoJGNoKTtyZXR1cm4gJHJlczt9CiAgIHB1YmxpYyBmdW5jdGlvbiBjdXJsKCR1cmwsICRwb3N0ID0gMCwgJGh0dHBoZWFkZXIgPSAwLCAkcHJveHkgPSAwKXsKICAgICAgICAkY2ggPSBjdXJsX2luaXQoKTsKICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHVybCk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgdHJ1ZSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgZmFsc2UpOwogICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWUhPU1QsIGZhbHNlKTsKICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAzMCk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCA2MCk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9DT09LSUUsVFJVRSk7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9DT09LSUVGSUxFLCJjb29raWUudHh0Iik7CiAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9DT09LSUVKQVIsImNvb2tpZS50eHQiKTsKICAgICAgICAgICAgaWYoJHBvc3QpewogICAgICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOwogICAgICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZigkaHR0cGhlYWRlcil7CiAgICAgICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSFRUUEhFQURFUiwgJGh0dHBoZWFkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCRwcm94eSl7CiAgICAgICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSFRUUFBST1hZVFVOTkVMLCB0cnVlKTsKICAgICAgICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QUk9YWSwgJHByb3h5KTsKICAgICAgICAgICAgICAgLy8gY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BST1hZVFlQRSwgQ1VSTFBST1hZX1NPQ0tTNSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwgdHJ1ZSk7CiAgICAgICAgICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2gpOwogICAgICAgICAgICAkaHR0cGNvZGUgPSBjdXJsX2dldGluZm8oJGNoKTsKICAgICAgICAgICAgICAgIGlmKCEkaHR0cGNvZGUpIHJldHVybiAiQ3VybCBFcnJvciA6ICIuY3VybF9lcnJvcigkY2gpOyBlbHNlewogICAgICAgICAgICAkaGVhZGVyID0gc3Vic3RyKCRyZXNwb25zZSwgMCwgY3VybF9nZXRpbmZvKCRjaCwgQ1VSTElORk9fSEVBREVSX1NJWkUpKTsKICAgICAgICAgICAgJGJvZHkgPSBzdWJzdHIoJHJlc3BvbnNlLCBjdXJsX2dldGluZm8oJGNoLCBDVVJMSU5GT19IRUFERVJfU0laRSkpOwogICAgICAgICAgICBjdXJsX2Nsb3NlKCRjaCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXkoJGhlYWRlciwgJGJvZHkpOwogICAgICAgICAgICB9CiAgIH0KICAgCiAgIHB1YmxpYyBmdW5jdGlvbiBnZXQoJHVybCwgJHVhKXsKICAgICByZXR1cm4gJHRoaXMtPmN1cmwoJHVybCwgbnVsbCwgJHVhKVsxXTsKICAgfQogICAKICAgcHVibGljIGZ1bmN0aW9uIHBvc3QoJHVybCwgJGRhdGEsICR1YSl7CiAgICAgcmV0dXJuICR0aGlzLT5jdXJsKCR1cmwsICRkYXRhLCAkdWEpWzFdOwogICB9CiAgIAogICBwdWJsaWMgZnVuY3Rpb24gU2F2ZSgkbmFtYWRhdGEpewogICAgICAgIGlmKGZpbGVfZXhpc3RzKCRuYW1hZGF0YSkpewogICAgICAgICAgICAkZGF0YSA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRuYW1hZGF0YSk7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICR0aGlzLT5iYW4oKTsKICAgICAgICAgICAgJGRhdGEgPSByZWFkbGluZSgiXDAzM1sxOzMybSBJbnB1dCAiLiRuYW1hZGF0YS4iIDogICIpOwogICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkbmFtYWRhdGEsJGRhdGEpOwogICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICRkYXRhOwogICB9CnB1YmxpYyBmdW5jdGlvbiBtZW51KCRubywkdHh0KXsKICAgZWNobyAkdGhpcy0+Y29sKCJbIiwicCIpLiR0aGlzLT5jb2woJG5vLCJoIikuJHRoaXMtPmNvbCgiXSIsInAiKS4iICIuJHRoaXMtPmNvbChzdHJ0b3VwcGVyKCR0eHQpLCJjIikuIlxuIjsKIH0KICAgcHVibGljIGZ1bmN0aW9uIHRtcigkdG1lcil7JGNvbG9yID0gYXJyYXkoIlwwMzNbMTszN20iLCJcMDMzWzA7MzFtIiwiXDAzM1swOzMzbSIsIlwwMzNbMDszMm0iLCJcMDMzWzA7MzRtIiwiXDAzM1swOzM1bSIpOyR0aW1lcj10aW1lKCkrJHRtZXI7d2hpbGUodHJ1ZSk6ZWNobyJcciBcciI7JHJlcz0kdGltZXItdGltZSgpOyBpZigkcmVzIDwgMSl7YnJlYWs7fSR0bSA9IGRhdGUoJyBpOnMgJywkcmVzKTtlY2hvIiBcMDMzWzE7MzdtIFsiLiRjb2xvcltyYW5kKDAsY291bnQoJGNvbG9yKS0xKV0uJHRtLiJcMDMzWzE7MzdtXSI7c2xlZXAoMSk7ZW5kd2hpbGU7fQogcHVibGljIGZ1bmN0aW9uIGxvYWQoJGRhdGEsICRmaWxlKXskaGFuZGxlID0gZm9wZW4oJGZpbGUsICd3Jyk7ZndyaXRlKCRoYW5kbGUsICRkYXRhKTtmY2xvc2UoJGhhbmRsZSk7IH0KIHB1YmxpYyBmdW5jdGlvbiB2MygpewokdWEgPSBhcnJheSgpOwogcmV0dXJuICR1YTsKIH0KcHVibGljIGZ1bmN0aW9uIHJlVjMoKXsKCndoaWxlKHRydWUpewogJHRoaXMtPlNsb3coaC4iIExvYWRpbmcgQW5jaG9yICAgICAgICAgXHIiKTsKICAgICAgICB1c2xlZXAoNTU1NTUpOwokY2hvcj1zZWxmOjpzYXZlKCJVcmxfYW5jaG9yIik7CgoJCSRiYXNlID0gZXhwbG9kZSgiJiIsJGNob3IpWzFdOwoJCSRjbyA9IGV4cGxvZGUoIiYiLCRjaG9yKVsyXTsKCQkkdiA9IGV4cGxvZGUoIiYiLCRjaG9yKVs0XTsJCgkkcmVzID0gJHRoaXMtPmN1cmwoJGNob3IsbnVsbCxhcnJheSgpKVsxXTsKCQkkdG9rZW4gPSBleHBsb2RlKCciPicsZXhwbG9kZSgnPGlucHV0IHR5cGU9ImhpZGRlbiIgaWQ9InJlY2FwdGNoYS10b2tlbiIgdmFsdWU9IicsJHJlcylbMV0pWzBdOwogJHRoaXMtPlNsb3coaC4iIFZhbGlkYXRpbmcgUmVjYXB0Y2hhVjMgICAgICAgICBcciIpOwogICAgICAgIHVzbGVlcCg1NTU1NSk7CiAgICAgICAJJHYzX3ZlcmlmID0gJHRoaXMtPmN1cmwoImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2FwaTIvcmVsb2FkPyIuJGJhc2UsIiR2JnJlYXNvbj1xJmM9JHRva2VuJiR2JiRjbyIsYXJyYXkoKSlbMV07CgkJJGNvayA9IGV4cGxvZGUoJyInLGV4cGxvZGUoJ1sicnJlc3AiLCInLCR2M192ZXJpZilbMV0pWzBdOwoJCWlmKCRjb2spewoJCWVjaG8gIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHIiOwoJCQlyZXR1cm4gJGNvazsKfWVsc2V7CiAgJHRoaXMtPlNsb3cobS4iIHdhaXQgICAgICAgICAgICBcciIpOwogICB9CiAgIH0KICAgfQpwdWJsaWMgZnVuY3Rpb24gcGFzKCl7CmF3YWxhbjokZCA9IGRhdGUoJ0QnKTsKc3dpdGNoKCRkKXsKY2FzZSAiU2F0IjoKJHB3ID0gIjY2NTU1NTU0MzMyMzQ0NDQiOwokbGluayA9ICJodHRwczovL2NhcmFwZWRpLmlkLzhJTVpFTzNLRlNTIjsKJGxpbmsyID0gImh0dHBzOi8vY2FyYXJlZ2lzdHJhc2kuY29tL201eWpadU1vViI7CmJyZWFrOwpjYXNlICJUaHUiOgokcHcgPSAiNzc2NTQ0MzMyNDU1NDMzNDU1NSI7CiRsaW5rID0gImh0dHBzOi8vY2FyYXBlZGkuaWQvbXcwdEwiOwokbGluazIgPSAiaHR0cHM6Ly9jYXJhcmVnaXN0cmFzaS5jb20vQ2NoaHlVaUNhUiI7CmJyZWFrOwpjYXNlICJGcmkiOgokcHcgPSAiMDk5OTk5Nzc3NjU1NTc3NTQ0NCI7CiRsaW5rID0gImh0dHBzOi8vY2FyYXBlZGkuaWQvZTVXcjUxMjJJIjsKJGxpbmsyID0gImh0dHBzOi8vY2FyYXJlZ2lzdHJhc2kuY29tL1pQNjB0cHJNOCI7CmJyZWFrOwpjYXNlICJNb24iOgokcHcgPSAiMTIzNDQyMjQ0NTY2NjQ0MzMzIjsKJGxpbmsgPSAiaHR0cHM6Ly9jYXJhcGVkaS5pZC9zYWd1U0ZPZWYiOwokbGluazIgPSAiaHR0cHM6Ly9jYXJhcmVnaXN0cmFzaS5jb20vREZOQzg4OTUyIjsKYnJlYWs7CmNhc2UgIlR1ZSI6CiRwdyA9ICI0NTY2NjMzMjI0NDU2Njc3NCI7CiRsaW5rID0gImh0dHBzOi8vY2FyYXBlZGkuaWQvVVptSmU3dyI7CiRsaW5rMiA9ICJodHRwczovL2NhcmFyZWdpc3RyYXNpLmNvbS85dWRnVmFTbHEiOwpicmVhazsKY2FzZSAiV2VkIjoKJHB3ID0gIjM0NDMyMzQ1NTY2NDQ0MzM0NTU0MzMzNDQ0NCI7CiRsaW5rID0gImh0dHBzOi8vY2FyYXBlZGkuaWQvazBleG9uUXFZbWQiOwokbGluazIgPSAiaHR0cHM6Ly9jYXJhcmVnaXN0cmFzaS5jb20vRHZybDJzYSI7CmJyZWFrOwpjYXNlICJTdW4iOgokcHcgPSAiODk5Nzc2ODY1NTU2NjQ0NTU1NTUiOwokbGluayA9ICJodHRwczovL2NhcmFwZWRpLmlkL1JlUU1lTzFpZyI7CiRsaW5rMiA9ICJodHRwczovL2NhcmFyZWdpc3RyYXNpLmNvbS9GMExPVmxLcnlmMSI7CmJyZWFrOwpkZWZhdWx0OgokcHcgPSAiZTliNTY1ZjhkM2IyNTU3OTZmMWZmYTUxMjBhYjM1ODUiOwokbGluayA9ICJodHRwczovL3BvbnNlbGhhcmlhbi5jb20vdVo2TGxxcWlrNSI7CiRsaW5rMiA9ICJodHRwczovL2NhcmFyZWdpc3RyYXNpLmNvbS9Oc0hZTUMwUGxvRSI7CmJyZWFrOwp9CiRyZWFkID0gZmlsZV9nZXRfY29udGVudHMoJ2tleS50eHQnKTsKaWYoJHJlYWQgIT0gJHB3KXsKJHRoaXMtPmJhbigpOwplY2hvICIgXDAzM1sxOzMybSBQYXNzd29yZCAgXDAzM1sxOzMybTogXDAzM1sxOzk3bSRsaW5rXG4iOwokcCA9IHJlYWRsaW5lKCIgXDAzM1sxOzMybUlucHV0IFBhc3N3b3JkIFwwMzNbMTszMm06IFwwMzNbMTs5N20iKTsKaWYoJHAgPT0gJHB3KXsKJHRoaXMtPmJhbigpOwokdGhpcy0+bG9hZCgkcCwgJ2tleS50eHQnKTsKZWNobyAiIFwwMzNbMTszMm1QYXNzd29yZCBjb3JyZWN0IjoaIFxuIjsKc2xlZXAoMSk7CmdvdG8gYXdhbGFuOwp9ZWxzZXsKJHRoaXMtPmJhbigpOwplY2hvICIgXDAzM1sxOzMxbVdyb25nIFBhc3N3b3JkLCBQbGVhc2UgSW5wdXQgYWdhaW4hXG4iOwpzbGVlcCgxKTsKZ290byBhd2FsYW47Cn19fQpwdWJsaWMgZnVuY3Rpb24gcygpeyRyZXM9ZmlsZV9nZXRfY29udGVudHMoYmFzZTY0X2RlY29kZSgiYUhSMGNITTZMeTl5WVhjdVoybDBhSFZpZFhObGNtTnZiblJsYm5RdVkyOXRMMU41ZFd0eWIyNHhNaTlUZVhWcmNtOXVNVEl2YldGcGJpOXpaWEoyWlhJdWNHaHciKSk7JGR1PWV4cGxvZGUoJyMnLGV4cGxvZGUoJyMnLnRpdGxlLic6JywkcmVzKVsxXSlbMF07JGN1PWV4cGxvZGUoJ3wnLCRkdSlbMF07O2lmKCRjdSA9PSAib2ZmIiB8fCAkY3UgPT0gbnVsbCl7Ym4xKCk7JHRoaXMtPlNsb3cobS4iIFNjcmlwdCBEaSBOb25ha3RpZmthblxuIik7JHRoaXMtPlNsb3cobS4iIEJ5IE1zayBPZmZpY2lhbCBcbiIpO2V4aXQ7fWlmKCRjdT09Im9uIil7fX0KICAgcHVibGljIGZ1bmN0aW9uIFNsb3coJG1zZyl7CiAgICAgICAgJHNsb3cgPSBzdHJfc3BsaXQoJG1zZyk7CiAgICAgICAgICAgICBmb3JlYWNoKCAkc2xvdyBhcyAkc2xvd21vICl7IAogICAgICAgICAgICAgICAgZWNobyAkc2xvd21vOyAKICAgICAgICAgICAgICAgIHVzbGVlcCg1NTUpOwogICAgICAgICAgICB9CiAgIH0KICAgcHVibGljIAlmdW5jdGlvbiBnKCl7CiAgICAgICAgZWNobyAkdGhpcy0+c2xvdyhwLicAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAJSUAAFxuIik7CiAgIH0KICAgcHVibGljIGZ1bmN0aW9uIGJhbigpewogICAgICAgICAgc3lzdGVtKCJjbGVhciIpOwogICAgICAgICAKICAgICAgICAgJHRoaXMtPnNsb3coIG0uJ62IVyAgra1Xra2Ira2IVyIpOyR0aGlzLT5TbG93KCBwLiIgIH8TXSBDUkVBVE9SICAgOiBNU0tcbiIpOwokdGhpcy0+U2xvdyggbS4if62Id62IdX2IrXVQda2IVyIpOyR0aGlzLT5TbG93KCBwLiIgfxNdIFRIQU5LUyBUTyA6IFRIRSBPTkUgQUxNSUdIVFkgR09EXG4iKTsKJHRoaXMtPlNsb3coIG0uIiVara2IdV0gra1RICWIrVEiKTskdGhpcy0+U2xvdyggcC4iIH8TXSBTVVBQT1JUICAgOiBBTEwgVEVBTSBYRC1GQU5UQVNZXG4iKTsKJHRoaXMtPlNsb3coIHAuIiWIrXWIrVcgra1RICWIrVEiKTskdGhpcy0+U2xvdyggcC4iIH8TXSBTVVBQT1JUICAgOiBCQUJZQk9UIENIQU5ORUxcbiIpOwokdGhpcy0+U2xvdyggcC4ira1UXSWIrXeIra2Ira1UXSIpOyR0aGlzLT5TbG93KCBwLiIgfxNdIFNDUklQVCAgICA6ICIuaG9zdC4iXG4iKTsKJHRoaXMtPlNsb3coIHAuJ39QXSAgf3Vdf3VQdXVQXSIpOyR0aGlzLT5TbG93KCBwLiIgIH8TXSBWRVJTSU9OICAgOiAiLnZlci4iXG4iKTsgIAogICAgICAgICAgJHRoaXMtPmcoKTsKICAgfQogIAogcHVibGljIGZ1bmN0aW9uIGJhbm5lcigkd2ViLCR2ZXIpewogICAgICAgICR0aGlzLT5iYW4oKTsKICB9ICAKICAKcHVibGljIGZ1bmN0aW9uIHNvbHZlbWVkaWEyKCRzb2wpewogICAgICAgIHdoaWxlKHRydWUpewogICAgICAgICAgICAkdWFfc29sID0gYXJyYXkoIkhvc3Q6IGFwaS1zZWN1cmUuc29sdmVtZWRpYS5jb20iLCJ1c2VyLWFnZW50OiAiLmZpbGVfZ2V0X2NvbnRlbnRzKCJVc2VyX0FnZW50IiksImFjY2VwdC1sYW5ndWFnZTogaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciKTsKICAgICAgICAgICAgJHVhX2ltZyA9IGFycmF5KCJVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTE7IFJNWDMxOTEgQnVpbGQvUlAxQS4yMDA3MjAuMDExOykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzk4LjAuNDc1OC44NyBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsImNvbnRlbnQtdHlwZTogYXBwbGljYXRpb24vanNvbiIpOwogICAgICAgICAgICAkY2hhbGxlbmdlID0gZXhwbG9kZSgnIicsZXhwbG9kZSgnImNoYWxsZW5nZSI6IicsJHRoaXMtPmdldCgkc29sLCR1YV9zb2wpKVsxXSlbMF07CiAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCJpbWFnZS5qcGciLCAkdGhpcy0+Z2V0KCdodHRwczovL2FwaS1zZWN1cmUuc29sdmVtZWRpYS5jb20vcGFwaS9tZWRpYT9jPScuJGNoYWxsZW5nZS4nO3c9MzAwO2g9MTUwO2ZnPTAwMDAwMDtiZz1mOGY4ZjgnLCR1YV9zb2wpKTsKICAgICAgICAgICAgJGJhc2UgPSBiYXNlNjRfZW5jb2RlKGZpbGVfZ2V0X2NvbnRlbnRzKCdpbWFnZS5qcGcnKSk7CiAgICAgICAgICAgICRyZXMgPSAkdGhpcy0+cG9zdCgiaHR0cHM6Ly92aXNpb24uZ29vZ2xlYXBpcy5jb20vdjEvaW1hZ2VzOmFubm90YXRlP2tleT1BSXphU3lDM3ktRW00Mmh0U0I4VUVaUHFwdEo3OHJsdkw1OF9oNlkiLCd7InJlcXVlc3RzIjpbeyJpbWFnZSI6eyJjb250ZW50IjoiJy4kYmFzZS4nIn0sImZlYXR1cmVzIjpbeyJ0eXBlIjoiVEVYVF9ERVRFQ1RJT04ifV19XX0nLCR1YV9pbWcpOwogICAgICAgICAgICAkdmFyMT0gZXhwbG9kZSgnInRleHQiOiAiRW50ZXIgdGhlIGZvbGxvd2luZzpcbicsICRyZXMpOwogICAgICAgICAgICAkdmFyMiA9IGV4cGxvZGUoJ1xuIicsICR2YXIxWzFdKTsKICAgICAgICAgICAgJHZhcjMgPSAkdmFyMlswXTsKICAgICAgICAgICAgJGNhcCA9IHN0cl9yZXBsYWNlKCdcbicsJyAnLCR2YXIzKTsKICAgICAgICAgICAgJGNhcGNoYSA9IHByZWdfcmVwbGFjZSgiL1teYS16XS8iLCAiIiwgJGNhcCk7CiAgICAgICAgICAgIGlmKCRjYXBjaGEpewogICAgICAgICAgICBlY2hvIG0uIiBUcnluZyBCeXBhc3MgICAgICAgICAgICAgICAgICAgICAgICAgXHIiOwogICAgICAgICAgICByZXR1cm4gImNoYWxsZW5nZT0iLiRjaGFsbGVuZ2UuIiZyZXNwb25lPSIuJGNhcGNoYTsKICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIGVjaG8gbS4iIFBsZWFzZSBXYWl0ICAgICAgICAgICAgICAgICAgICAgICAgICBcciI7CiAgICAgICAgICAgICAgCiAgICAgICAgfQogICAgfSAgICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyBmdW5jdGlvbiBzb2x2ZW1lZGlhKCRzb2wpewogICAgICAgIHdoaWxlKHRydWUpewogICAgICAgICAgICAkdWFfc29sID0gYXJyYXkoIkhvc3Q6IGFwaS1zZWN1cmUuc29sdmVtZWRpYS5jb20iLCJ1c2VyLWFnZW50OiAiLmZpbGVfZ2V0X2NvbnRlbnRzKCJVc2VyX0FnZW50IiksImFjY2VwdC1sYW5ndWFnZTogaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciKTsKICAgICAgICAgICAgJHVhX2ltZyA9IGFycmF5KCJVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTE7IFJNWDMxOTEgQnVpbGQvUlAxQS4yMDA3MjAuMDExOykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzk4LjAuNDc1OC44NyBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsImNvbnRlbnQtdHlwZTogYXBwbGljYXRpb24vanNvbiIpOwogICAgICAgICAgICAkY2hhbGxlbmdlID0gZXhwbG9kZSgnIicsZXhwbG9kZSgnImNoYWxsZW5nZSI6IicsJHRoaXMtPmdldCgkc29sLCR1YV9zb2wpKVsxXSlbMF07CiAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCJpbWFnZS5qcGciLCAkdGhpcy0+Z2V0KCdodHRwczovL2FwaS1zZWN1cmUuc29sdmVtZWRpYS5jb20vcGFwaS9tZWRpYT9jPScuJGNoYWxsZW5nZS4nO3c9MzAwO2g9MTUwO2ZnPTAwMDAwMDtiZz1mOGY4ZjgnLCR1YV9zb2wpKTsKICAgICAgICAgICAgJGJhc2UgPSBiYXNlNjRfZW5jb2RlKGZpbGVfZ2V0X2NvbnRlbnRzKCdpbWFnZS5qcGcnKSk7CiAgICAgICAgICAgICRyZXMgPSAkdGhpcy0+cG9zdCgiaHR0cHM6Ly92aXNpb24uZ29vZ2xlYXBpcy5jb20vdjEvaW1hZ2VzOmFubm90YXRlP2tleT1BSXphU3lDM3ktRW00Mmh0U0I4VUVaUHFwdEo3OHJsdkw1OF9oNlkiLCd7InJlcXVlc3RzIjpbeyJpbWFnZSI6eyJjb250ZW50IjoiJy4kYmFzZS4nIn0sImZlYXR1cmVzIjpbeyJ0eXBlIjoiVEVYVF9ERVRFQ1RJT04ifV19XX0nLCR1YV9pbWcpOwogICAgICAgICAgICAkdmFyMT0gZXhwbG9kZSgnInRleHQiOiAiRW50ZXIgdGhlIGZvbGxvd2luZzpcbicsICRyZXMpOwogICAgICAgICAgICAkdmFyMiA9IGV4cGxvZGUoJ1xuIicsICR2YXIxWzFdKTsKICAgICAgICAgICAgJHZhcjMgPSAkdmFyMlswXTsKICAgICAgICAgICAgJGNhcCA9IHN0cl9yZXBsYWNlKCdcbicsJyAnLCR2YXIzKTsKICAgICAgICAgICAgJGNhcGNoYSA9IHByZWdfcmVwbGFjZSgiL1teYS16XS8iLCAiIiwgJGNhcCk7CiAgICAgICAgICAgIGlmKCRjYXBjaGEpewogICAgICAgICAgICBlY2hvIG0uIiBUcnluZyBCeXBhc3MgICAgICAgICAgICAgICAgICAgICAgICAgXHIiOwogICAgICAgICAgICByZXR1cm4gImFkY29weV9yZXNwb25zZT0iLiRjYXBjaGEuIiZhZGNvcHlfY2hhbGxlbmdlPSIuJGNoYWxsZW5nZTsKICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIGVjaG8gbS4iIFBsZWFzZSBXYWl0ICAgICAgICAgICAgICAgICAgICAgICAgICBcciI7CiAgICAgICAgICAgICAgCiAgICAgICAgfQogICAgfSAgICAgCiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gYm90KCR4LCR5LCR6KXsKICAgIAlyZXR1cm4gWyIrIi4keS4iKyIuJHouIisiLiR4LCIrIi4keC4iKyIuJHkuIisiLiR6LCIrIi4keC4iKyIuJHouIisiLiR5LCIrIi4keS4iKyIuJHguIisiLiR6LCIrIi4kei4iKyIuJHkuIisiLiR4LCIrIi4kei4iKyIuJHguIisiLiR5XTsKICAgIH0KICAgIHB1YmxpYyBmdW5jdGlvbiB4KCRhd2FsLCRha2hpciwkcmVzLCRubyl7CiAgICAkZGF0YSA9IGV4cGxvZGUoJGFraGlyLGV4cGxvZGUoJGF3YWwsJHJlcylbJG5vXSlbMF07CiAgICAgICAgcmV0dXJuICRkYXRhOwogIH0KICAgIHB1YmxpYyBmdW5jdGlvbiBDb2woJHN0ciwkY29sb3IpewogICAgICAgIGlmKCRjb2xvcj09InJhbmQiKXsKICAgICAgICAgICAgJGNvbG9yPVsnaCcsJ2snLCdwJywnaycsJ20nXVthcnJheV9yYW5kKFsnaCcsJ2snLCdiJywndScsJ20nXSldOwogICAgICAgIH0KICAgICAkd2FyPWFycmF5KCdydyc9PiJcMDMzWzEwN21cMDMzWzE7MzFtIiwncnQnPT4iXDAzM1sxMDZtXDAzM1sxOzMxbSIsJ2h0Jz0+IlwwMzNbMDszMG0iLCdwJz0+IlwwMzNbMTs5N20iLCdhJz0+IlwwMzNbMTszMG0iLCdtJz0+IlwwMzNbMTszMW0iLCdoJz0+IlwwMzNbMTszMm0iLCdrJz0+IlwwMzNbMTszM20iLCdiJz0+IlwwMzNbMTszNG0iLCd1Jz0+IlwwMzNbMTszNW0iLCdjJz0+IlwwMzNbMTszNm0iLCdycic9PiJcMDMzWzEwMW1cMDMzWzE7MzdtIiwncmcnPT4iXDAzM1sxMDJtXDAzM1sxOzM0bSIsJ3J5Jz0+IlwwMzNbMTAzbVwwMzNbMTszMG0iLCdycDEnPT4iXDAzM1sxMDRtXDAzM1sxOzM3bSIsJ3JwMic9PiJcMDMzWzEwNW1cMDMzWzE7MzdtIik7CiAgICAgICAgICAgIHJldHVybiAkd2FyWyRjb2xvcl0uJHN0ci4iXDAzM1swbSI7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gYW50YigkcmVzLCRubyl7CiAgICAgICAgJGJvdCA9ICR0aGlzLT54KCdyZWw9XCInLCdcIicsJHJlcywkbm8pOwogICAgICAgICAgIHJldHVybiAkYm90OwogICAgfQogICAgcHVibGljIGZ1bmN0aW9uIHJhbmRvbXVhKCl7CgkgICAgJHVybCA9IGZpbGVfZ2V0X2NvbnRlbnRzKCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYmFnYXMtcC9EYXRhL21haW4vdWEudHh0Iik7CgkgICAgcHJlZ19tYXRjaF9hbGwoIi8oXHMuKikvaSIsJHVybCwkdWEpOwoJICAgICRhcnIgPSBhcnJheV9maWx0ZXIoJHVhWzFdLCdzdHJsZW4nKTsKCSAgICAgICAgcmV0dXJuIHRyaW0oJGFyclthcnJheV9yYW5kKCRhcnIpXSk7CiAgICB9CiAgICAKICAgcHVibGljIGZ1bmN0aW9uIHB3KCl7CiAgIHBzOgokZD1kYXRlKCdEJyk7CiAKJGdldD1maWxlX2dldF9jb250ZW50cyhiYXNlNjRfZGVjb2RlKCJhSFIwY0hNNkx5OXlaVzUwY25rdVkyOHZjR0Z6T1RVdmNtRjMiKSk7CgoKICRsaW5rID0ganNvbl9kZWNvZGUoJGdldCktPlBhc3N3b3JkLT4kZC0+TGluazsKICAgICRsaW5rMiA9IGpzb25fZGVjb2RlKCRnZXQpLT5QYXNzd29yZC0+JGQtPkxpbmsyOwogICAgJHB3ID0ganNvbl9kZWNvZGUoJGdldCktPlBhc3N3b3JkLT4kZC0+UGFzc3dvcmQ7CmlmKCRsaW5rKXsKICAgICAgICAgICAgJHJlYWQgPSBmaWxlX2dldF9jb250ZW50cygna2V5LnR4dCcpOwogICAgICAgICAgICAgICAgaWYoJHJlYWQgIT0gJHB3KXsKICAgICAgICAgICAgICAgICAgIHNlbGY6OmJhbigpOwogICAgICAgICAgICAgICAgICAgIGVjaG8gIiBcMDMzWzE7MzJtIExJbmsgMSBcMDMzWzE7MzJtOiBcMDMzWzE7OTdtJGxpbmtcbiI7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgJHAgPSByZWFkbGluZSgiIFwwMzNbMTszMm1JbnB1dCBcMDMzWzE7MzJtOiBcMDMzWzE7OTdtIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRwID09ICRwdyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOjpiYW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCdrZXkudHh0JywkcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvIiBcMDMzWzE7MzJtUGFzc3dvcmQgQ29ycmVjdCIaIFxuIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsZWVwKDEpOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OmJhbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyIgXDAzM1sxOzMxbSBJbnZhbGlkIFBhc3N3b3JkIVxuIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gcHM7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgfQogICAgICAgIH1lbHNlewogICAgICAgICAgICAKICAgICAgICAgICBlY2hvICIgXDAzM1sxOzMxbVBsZWFzZSBjZWsgeW91ciBjb25lY3Rpb24hXG4iOwogICAgICAgICAgICBleGl0OwogICAgICAgIH0KICAgfQogICAgcHVibGljIGZ1bmN0aW9uIHNvbHZlbWVkaWFfb2NyKCRzb2wpewogICAgICAgIHdoaWxlKHRydWUpewogICAgICAgICAgICAkdWFfc29sID0gYXJyYXkoIkhvc3Q6IGFwaS1zZWN1cmUuc29sdmVtZWRpYS5jb20iLCJ1c2VyLWFnZW50OiAiLmZpbGVfZ2V0X2NvbnRlbnRzKCJVc2VyX0FnZW50IiksImFjY2VwdC1sYW5ndWFnZTogaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciKTsKICAgICAgICAgICAgJHVhX2ltZyA9IGFycmF5KCJVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTE7IFJNWDMxOTEgQnVpbGQvUlAxQS4yMDA3MjAuMDExOykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzk4LjAuNDc1OC44NyBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsImNvbnRlbnQtdHlwZTogYXBwbGljYXRpb24vanNvbiIpOwogICAgICAgICAgICAkY2hhbGxlbmdlID0gZXhwbG9kZSgnIicsZXhwbG9kZSgnImNoYWxsZW5nZSI6IicsJHRoaXMtPmdldCgkc29sLCR1YV9zb2wpKVsxXSlbMF07CiAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCJpbWcuanBnIiwgJHRoaXMtPmdldCgnaHR0cHM6Ly9hcGktc2VjdXJlLnNvbHZlbWVkaWEuY29tL3BhcGkvbWVkaWE/Yz0nLiRjaGFsbGVuZ2UuJzt3PTMwMDtoPTE1MDtmZz0wMDAwMDA7Ymc9ZjhmOGY4JywkdWFfc29sKSk7CiAgICAgICAgICAgICRhcGlrZXk9IjZhODRmMTk3OTA4ODk1NyI7CiAgICAgICAgICAgIHN5c3RlbSgnY29udmVydCBpbWcuanBnIC1ncmF2aXR5IE5vcnRoIC1jaG9wIHgxNSBjYXB0Y2hhLnBuZyAyPi9kZXYvbnVsbCcpOwogICAgICAgICAgICAkaGFzaWwgPSBqc29uX2RlY29kZShzaGVsbF9leGVjKCdjdXJsIC0tc2lsZW50IC1IICJhcGlrZXk6Jy4kYXBpa2V5LiciIC0tZm9ybSAiZmlsZT1AY2FwdGNoYS5wbmciIC0tZm9ybSAibGFuZ3VhZ2U9ZW5nIiAtLWZvcm0gIm9jcmVuZ2luZT0yIiAtLWZvcm0gImlzT3ZlcmxheVJlcXVpcmVkPWZhbHNlIiAtLWZvcm0gImlzY3JlYXRlc2VhcmNoYWJsZXBkZj1mYWxzZSIgaHR0cHM6Ly9hcGkub2NyLnNwYWNlL1BhcnNlL0ltYWdlJykpLT5QYXJzZWRSZXN1bHRzWzBdLT5QYXJzZWRUZXh0OyAgICAgICAgICAgCiAgICAgICAgICAgICRjYXBjaGEgPSBwcmVnX3JlcGxhY2UoIi9bXmEtekEtWl0vIiwiIiwgJGhhc2lsKTsKICAgICAgICAgICAgICAgIGlmKHN0cmxlbigkY2FwY2hhKSA+PSAyMCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJhZGNvcHlfcmVzcG9uc2U9Ii4kY2FwY2hhLiImYWRjb3B5X2NoYWxsZW5nZT0iLiRjaGFsbGVuZ2U7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBlY2hvIG0uIiBXYWl0ICAgICAgICAgICAgICAgICAgICAgICAgICBcciI7CiAgICAgICAgICAgICAgICAgICAgaWYoZmlsZV9leGlzdHMoImltZy5qcGciKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbSgicm0gaW1nLmpwZyIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihmaWxlX2V4aXN0cygiY2FwdGNoYS5wbmciKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHN5c3RlbSgicm0gY2FwdGNoYS5wbmciKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAKICAgCgogICAgcHVibGljIGZ1bmN0aW9uIHByb3h5KCl7CiAgICB1OgogICAgaWYoZmlsZV9leGlzdHMoInByb3h5LnR4dCIpKXsKICAgICAgICAka28gPSBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9pcGVjaG8ubmV0L3BsYWluJyk7CiAgICAgICAgJGloID0gZmlsZV9nZXRfY29udGVudHMoInByb3h5LnR4dCIpOwogICAgICAgICRnZXQgPSR0aGlzLT4gY3VybCgnaHR0cHM6Ly9pcGVjaG8ubmV0L3BsYWluJywnJywnJywkaWgpWzFdOwogICAgICAgICAgICBpZihzdHJwb3MoJGloLCRnZXQpKXsKICAgICAgICAgICAgICAgIGVjaG8gcC4iIFByb3h5IEFjdGl2ZSB+PiAiLmguJGloLiJcbiI7CiAgICAgICAgICAgICAgICByZXR1cm4gJGloOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGE6CiAgICAgICAgICAgICAgICAkaXAgPSBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9pcGVjaG8ubmV0L3BsYWluJyk7CiAgICAJICAgICAgICAkZmlsZT1qc29uX2RlY29kZSgkdGhpcy0+Y3VybCgiaHR0cHM6Ly9naW1tZXByb3h5LmNvbS9hcGkvZ2V0UHJveHk/Z2V0PXRydWUmc3VwcG9ydHNIdHRwcz10cnVlJm1heENoZWNrUGVyaW9kPTM2MDAiKVsxXSwxKTsKICAgIAkgICAgICAgICRpcHggPSAkdGhpcy0+Y3VybCgnaHR0cHM6Ly9pcGVjaG8ubmV0L3BsYWluJywnJywnJywkZmlsZVsiaXBQb3J0Il0pWzFdOwogICAgICAgIAkgICAgICAgIGlmKCRpcHggPT0gJGlwIHx8ICRpcHggPD0gbnVsbCl7CiAgICAgICAgCSAgICAgICAgICAgIGVjaG8gcC4iIFNlYXJjaCBQcm94eSAgIi5oLiRmaWxlWyJpcFBvcnQiXS4iICAgICAgICAgICAgICAgICAgICAgICAgICAgXHIiOyAgICAKICAgICAgICAJCSAgICAgICAgZ290byBhOwogICAgICAgIAkgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgCSAgICBlY2hvIHAuIiBQcm94eSA9PiAiLmguJGZpbGVbImlwUG9ydCJdLiIgQ29uZWN0ZWQhIFxuIjsgICAgCiAgICAgICAgICAgICAgICAJCSRzYXZlID0gZm9wZW4oInByb3h5LnR4dCIsICJ3Iik7CiAgICAgICAgICAgIAkgICAgICAgICBmd3JpdGUoJHNhdmUsICRmaWxlWyJpcFBvcnQiXSk7CiAgICAgICAgICAgIAkgICAgICAgICBmY2xvc2UoJHNhdmUpOyAgICAgICAgCgkgICAgICAgICAgICAgICAgfQoJICAgICAgIH0KCX1lbHNlewoJICAgICRzYXZlID0gZm9wZW4oInByb3h5LnR4dCIsICJ3Iik7CQogICAgICAgICAgICAJIGZjbG9zZSgkc2F2ZSk7CgkgICAgZ290byB1OwoJfQp9CgoKICAgICAgCiAgICBwdWJsaWMgZnVuY3Rpb24gYW55Y2FwdGNoYSgkYXBpa2V5LCRwYWdldXJsLCR3ZWJrZXkpewogICAgICAgICAgICAgICAgazoKICAgICAgICAgICAgICAgICR1YSA9IGFycmF5KCJIb3N0OiBhcGkuYW55Y2FwdGNoYS5jb20iLCJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iKTsKICAgICAgICAgICAgICAgICRkYXRhID0gJ3siY2xpZW50S2V5IjogIicuJGFwaWtleS4nIiwidGFzayI6eyJ0eXBlIjogIlJlY2FwdGNoYVYzVGFza1Byb3h5bGVzcyIsIndlYnNpdGVVUkwiOiAiJy4kcGFnZXVybC4nIiwid2Vic2l0ZUtleSI6ICInLiR3ZWJrZXkuJyIsImlzSW52aXNpYmxlIjogZmFsc2V9fSc7CiAgICAgICAgICAgICAgICAkciA9ICR0aGlzLT5wb3N0KCJodHRwczovL2FwaS5hbnljYXB0Y2hhLmNvbS9jcmVhdGVUYXNrIiwgJGRhdGEsICR1YSk7CiAgICAgICAgICAgICAgICAkbXNnID0ganNvbl9kZWNvZGUoJHIpLT5lcnJvckRlc2NyaXB0aW9uOwogICAgICAgICAgICAgICAgJGlkID0ganNvbl9kZWNvZGUoJHIpLT50YXNrSWQ7CiAgICAgICAgICAgICAgIGE6CiAgICAgICAgICAgICAgICRkYXRhXzIgPSAneyJjbGllbnRLZXkiOiAiJy4kYXBpa2V5LiciLCAidGFza0lkIjogJy4kaWQuJ30nOwogICAgICAgICAgICAgICAkcjIgPSAkdGhpcy0+cG9zdCgiaHR0cHM6Ly9hcGkuYW55Y2FwdGNoYS5jb20vZ2V0VGFza1Jlc3VsdCIsICRkYXRhXzIsICR1YSk7CiAgICAgICAgICAgICAgICRtc2cgPSBqc29uX2RlY29kZSgkcjIpLT5zdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgaWYoJG1zZyA9PSAicHJvY2Vzc2luZyIpewogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+U2xvdyhoLiJTZW5kIFJlcXVlc3RzICAgICBcciIpOwogICAgICAgICAgICAgICAgICAgICAgICBzbGVlcCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ290byBhOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgJHJlc3BvbiA9IGpzb25fZGVjb2RlKCRyMiktPnNvbHV0aW9uLT5nUmVjYXB0Y2hhUmVzcG9uc2U7CiAgICAgICAgICAgICAgICAgICAgIGlmKCRyZXNwb24gPT0gbnVsbCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPlNsb3cobS4iIEludmFsaWQgUmVxdWVzdCAgICAgICAgXHIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBzbGVlcCgyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGs7CiAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRyZXNwb247CiAgICAgICAgICAgICAgICAgICAgfSAgCiAgICB9ICAgICAgCiAgICAKIH0KIAoKIGNsYXNzIGJvdCBleHRlbmRzIG1vZHVsewogCiAKCgogcHVibGljIGZ1bmN0aW9uIGZhdWNldCgpeyR1YSA9IGFycmF5KCJIb3N0OiAiLmhvc3QsIlgtUmVxdWVzdGVkLVdpdGg6IFhNTEh0dHBSZXF1ZXN0IiwidXNlci1hZ2VudDogIi5maWxlX2dldF9jb250ZW50cygiVXNlcl9BZ2VudCIpLCJDb29raWU6ICIuZmlsZV9nZXRfY29udGVudHMoIkNvb2tpZSIpKTsgCm1hbnVhbDoKIHdoaWxlKHRydWUpewogJHIgPSAkdGhpcy0+Z2V0KCJodHRwczovL2NsYWltc2F0b3NoaS54eXovZmF1Y2V0IiwkdWEpOwogaWYocHJlZ19tYXRjaCgnL0ZpcmV3YWxsLycsJHIpKXtzZWxmOjpGaXJld2FsbCgkdWEpOyB9CgogJHRpbWUgPSBleHBsb2RlKCcgLSAxOycsZXhwbG9kZSgndmFyIHdhaXQgPSAnLCRyKVsxXSlbMF07CiBpZigkdGltZSl7JHRoaXMtPnRtcigkdGltZSk7fQogCiRjYXAgPSAkdGhpcy0+cmVWMygpOwpmb3IoJGk9MDskaTw3OyRpKyspewppZigkaT09Nil7CiR0aGlzLT4gU2xvdyhtLiIgSW52YWxpZCAgICAgICBcciIpOyAKc2xlZXAoMSk7CmdvdG8gbWFudWFsOwp9CiAkciA9ICR0aGlzLT5nZXQoImh0dHBzOi8vY2xhaW1zYXRvc2hpLnh5ei9mYXVjZXQiLCAkdWEpOwokYiA9IGV4cGxvZGUoJ1wiI1wiIHJlbD1cIicsJHIpOwokYjEgPSBleHBsb2RlKCdcIicsJGJbMV0pWzBdOwokYjIgPSBleHBsb2RlKCdcIicsJGJbMl0pWzBdOwokYjMgPSBleHBsb2RlKCdcIicsJGJbM10pWzBdOwokYm90ID0kdGhpcy0+IGJvdCgkYjEsJGIyLCRiMylbJGldOwokY3NyZiA9ICR0aGlzLT54KCdpZD0idG9rZW4iIHZhbHVlPSInLCciJywkciwxKTsKJHRrID0gJHRoaXMtPngoJ25hbWU9InRva2VuIiB2YWx1ZT0iJywnIicsJHIsMSk7CiR3YWw9ZmlsZV9nZXRfY29udGVudHMoImVtYWlsX2ZwIik7CiRkYXRhID0gImFudGlib3RsaW5rcz0kYm90WyRpXSZjc3JmX3Rva2VuX25hbWU9JGNzcmYmdG9rZW49JHRrJmNhcHRjaGE9cmVjYXB0Y2hhdjMmcmVjYXB0Y2hhdjM9JGNhcCZnLXJlY2FwdGNoYS1yZXNwb25zZT0iOwogICAgICAgICAgICRyMiA9IHNlbGY6OnBvc3QoImh0dHBzOi8vY2xhaW1zYXRvc2hpLnh5ei9mYXVjZXQvdmVyaWZ5IiwgJGRhdGEsICR1YSk7CiAgICAgICAgICBpZihwcmVnX21hdGNoKCcvRmlyZXdhbGwvJywkcjIpKXtzZWxmOjpGaXJld2FsbCgkdWEpOyB9CiAgICAgICAgICAgJHN1Yz1leHBsb2RlKCInLCIsZXhwbG9kZSgiR29vZCBqb2IhJywgJyIsJHIyKVsxXSlbMF07CgogICAgICAgICAgICAkZiA9IGV4cGxvZGUoJzwnLGV4cGxvZGUoJzxwIGNsYXNzPSJsaC0xIG1iLTEgZm9udC13ZWlnaHQtYm9sZCI+JywkcilbM10pWzBdOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkc3VjKXsKICAgICAgICAgICAgICAgICAgICAgICAgJHIgPSAkdGhpcy0+Z2V0KCJodHRwczovL2NsYWltZGdiLnh5ei9mYXVjZXQvY3VycmVuY3kvZGdiIiwgJHVhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gaC4iPl8gR29vZCBKb2IhICIucC4kc3VjLiJcbiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOjpiYWxhbmNlKCR1YSk7CiAgc2VsZjo6Y2xhaW0oJHVhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gbWFudWFsOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsgICAgICAKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIH0KICAgICAgICB9fQogIHB1YmxpYyBmdW5jdGlvbiBwdGMoKXsKICAgICAgICBwdGM6CiAgICAgICAgd2hpbGUodHJ1ZSl7CiAgICAgICAgCiAgICAgICAgJGNhcCA9ICR0aGlzLT5yZVYzKCk7CiAgICAgICRyID0gJHRoaXMtPmdldCgiaHR0cHM6Ly9jbGFpbXNhdG9zaGkueHl6L3B0YyIsICR1YSk7IAogICAgICAkdGltZSA9IHNlbGY6OngoJzxzcGFuIGNsYXNzPSJtcy1hdXRvIGJnLXB1cnBsZSI+VGltZTogJywic2VjIiwkciwxKTsKICAgICAgJGlkID0gc2VsZjo6eCgnaHR0cHM6Ly9jbGFpbXNhdG9zaGkueHl6L3B0Yy92aWV3LycsIiciLCRyLDEpOwogICAgICAgICBpZigkaWQ9PW51bGwpewogICAgICAgICAkdGhpcy0+U2xvdyhtLiIgUHRjIEhhYmlzXG4iKTsKICAgICAgICAgJHRoaXMtPmcoKTsKICAgICAgICAgZXhpdDsKICAgICAgICAgfQogICAgICAgJHIgPSBzZWxmOjpnZXQoImh0dHBzOi8vY2xhaW1zYXRvc2hpLnh5ei9wdGMvdmlldy8kaWQiLCAkdWEpOwogICAgICAkY3NyZiA9IHNlbGY6OngoJ25hbWU9ImNzcmZfdG9rZW5fbmFtZSIgdmFsdWU9IicsJyInLCRyLDEpOwokdGsgPSBzZWxmOjp4KCduYW1lPSJ0b2tlbiIgdmFsdWU9IicsJyInLCRyLDEpOwogIHNlbGY6OnRtcigkdGltZSk7ICAgICAKCiAgICAgICRkYXRhID0gImNhcHRjaGE9cmVjYXB0Y2hhdjMmcmVjYXB0Y2hhdjM9JGNhcCZjc3JmX3Rva2VuX25hbWU9JGNzcmYmdG9rZW49JHRrIjsKICAgICAgICAgICAkcjIgPSBzZWxmOjpwb3N0KCJodHRwczovL2NsYWltc2F0b3NoaS54eXovcHRjL3ZlcmlmeS8kaWQiLCAkZGF0YSwgJHVhKTsKICAgICAgICAgICAgJHN1Yz1leHBsb2RlKCInLCIsZXhwbG9kZSgiR29vZCBqb2IhJywgJyIsJHIyKVsxXSlbMF07CiAgICAgICAgICAgICRmID0gc2VsZjo6eCgnPHAgY2xhc3M9ImxoLTEgbWItMSBmb250LXdlaWdodC1ib2xkIj4nLCc8JywkcjIsMyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzdWMpewogICAgICBlY2hvIGguIj5fIEdvb2Qgam9iIScsICIucC4kc3VjLiJcbiI7CiBzZWxmOjpiYWxhbmNlKCR1YSk7CiR0aGlzLT5nKCk7CmdvdG8gcHRjOwogICB9ZWxzZXsKIGdvdG8gcHRjOwogICAgICB9CiAgICB9Cn0KcHVibGljIGZ1bmN0aW9uIHdkKCl7CndkOgogICRyID0gJHRoaXMtPmdldCgiaHR0cHM6Ly9oYXJzaGNvaW4uY29tL3dpdGhkcmF3IiwgJHVhKTsgCiAkY3NyZiA9IHNlbGY6OngoJ25hbWU9ImNzcmZfdG9rZW5fbmFtZSIgdmFsdWU9IicsJyInLCRyLDEpOwogJGFtb24gPSBzZWxmOjp4KCc8aW5wdXQgdHlwZT0ibnVtYmVyIiBuYW1lPSJhbW91bnQiIGlkPSJ0b2tlbkJhbGFuY2UiIHZhbHVlPSInLCciJywkciwxKTsKJHdhbD1maWxlX2dldF9jb250ZW50cygiZW1haWxfZnAiKTsKICAkZGF0YSA9ICJjc3JmX3Rva2VuX25hbWU9JGNzcmYmbWV0aG9kPSRtZXQmYW1vdW50PSRhbW9uJndhbGxldD0kd2FsIjsKIGVjaG8gJGN5YW4uIiBbMl0uTFRDXG4iOwplY2hvICRjeWFuLiIgWzVdLkRHQlxuIjsKZWNobyAkY3lhbi4iIFs2XS5CVENcbiI7CmVjaG8gJGN5YW4uIiBbN10uVFJYXG4iOwokbWV0PXJlYWRsaW5lKCJJTlBVVCBOVU1CRVI6ICIpOwogIAogIAogIAogICAgICAgICAgICRyMiA9IHNlbGY6OnBvc3QoImh0dHBzOi8vaGFyc2hjb2luLmNvbS93aXRoZHJhdy93aXRoZHJhdyIsICRkYXRhLCAkdWEpOwogICAgICAgICAgICAkc3VjID0gc2VsZjo6eCgiR29vZCBqb2IhJywgJyIsIiEnLCAnc3VjY2VzcyIsJHIyLDEpOwogICAgICAgICAgICAkZiA9IHNlbGY6OngoJzxwIGNsYXNzPSJsaC0xIG1iLTEgZm9udC13ZWlnaHQtYm9sZCI+JywnPCcsJHIxLDMpOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkc3VjKXsKZWNobyBoLiI+XyBHb29kIGpvYiEnLCAiLnAuJHN1Yy4iXG4iOwpleGl0Owp9ZWxzZXsKZWNobyBtLiIgSW52YWxpZFxuIjsKZXhpdDsKfQp9CgpwdWJsaWMgZnVuY3Rpb24gRmlyZXdhbGwoJHVhKXsKICAgICAgICAgICAgICAgYToKICAgICAgICAgICAkY2FwID0gJHRoaXMtPnJlVjMoKTsKICAgICAgICRyID0gJHRoaXMtPmdldCgiaHR0cHM6Ly9jbGFpbXNhdG9zaGkueHl6L2ZpcmV3YWxsIiwgJHVhKTsgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAkY3NyZiA9ICR0aGlzLT54KCdjc3JmX3Rva2VuX25hbWUiIHZhbHVlPSInLCciJywkciwxKTsKICAgICAgICAgICAgICAgICRkYXRhID0gInJlY2FwdGNoYXYzPSRjYXAmY2FwdGNoYVR5cGU9cmVjYXB0Y2hhdjMmY3NyZl90b2tlbl9uYW1lPSRjc3JmIjsKICAgICAgICAgICAkcjIgPSBzZWxmOjpwb3N0KCJodHRwczovL2NsYWltc2F0b3NoaS54eXovZmlyZXdhbGwvdmVyaWZ5IiwgJGRhdGEsICR1YSk7CiAgICAgICAgICAgCiAgICAgICAgICAgaWYocHJlZ19tYXRjaCgnL0ZpcmV3YWxsLycsJHIyKSl7c2VsZjo6RmlyZXdhbGwoJHVhKTsgfWVsc2V7CgogICAgICAgICAKCWVjaG8gaC4iPl8gU3VjY2VzcyBCeXBhc3MgRmlyZXdhbGxcbiI7CglzbGVlcCg1KTsKCXNlbGY6OmcoKTsKCSR0aGlzLT5mYXVjZXQoKTsKfX0KCgogIHB1YmxpYyBmdW5jdGlvbiBiYWxhbmNlKCR1YSl7ICAgIAogICR1YSA9IGFycmF5KCJIb3N0OiAiLmhvc3QsIlgtUmVxdWVzdGVkLVdpdGg6IFhNTEh0dHBSZXF1ZXN0IiwidXNlci1hZ2VudDogIi5maWxlX2dldF9jb250ZW50cygiVXNlcl9BZ2VudCIpLCJDb29raWU6ICIuZmlsZV9nZXRfY29udGVudHMoIkNvb2tpZSIpKTsgCiAgICBlY2hvIGguIj5fIEJhbGFuY2UgLT4gIi5wLnNlbGY6OngoJzxoMiBjbGFzcz0iY2FyZC10aXRsZSB0ZXh0LXdoaXRlIj4nLCc8JyxzZWxmOjpnZXQoImh0dHBzOi8vY2xhaW1zYXRvc2hpLnh5ei9kYXNoYm9hcmQiLCAkdWEpLDEpLiJcbiI7CiAgICAgICAgICAgfQogICBwdWJsaWMgZnVuY3Rpb24gY2xhaW0oJHVhKXsKICAgJHVhID0gYXJyYXkoIkhvc3Q6ICIuaG9zdCwiWC1SZXF1ZXN0ZWQtV2l0aDogWE1MSHR0cFJlcXVlc3QiLCJ1c2VyLWFnZW50OiAiLmZpbGVfZ2V0X2NvbnRlbnRzKCJVc2VyX0FnZW50IiksIkNvb2tpZTogIi5maWxlX2dldF9jb250ZW50cygiQ29va2llIikpOyAKICAgIGVjaG8gaC4iPl8gQ2xhaW1MZWZ0IC0+ICIucC5zZWxmOjp4KCc8aDIgY2xhc3M9ImNhcmQtdGl0bGUgdGV4dC13aGl0ZSI+JywnPCcsc2VsZjo6Z2V0KCJodHRwczovL2NsYWltc2F0b3NoaS54eXovZmF1Y2V0IiwgJHVhKSw0KS4iXG4iOwogICAgICAgICAgfQpwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKXsKCnNlbGY6OnMoKTsKc2VsZjo6cHcoKTsKJGNvaz1zZWxmOjpzYXZlKCJDb29raWUiKTsKJHVzZXI9c2VsZjo6c2F2ZSgiVXNlcl9BZ2VudCIpOwokY2hvcj1zZWxmOjpzYXZlKCJVcmxfYW5jaG9yIik7CgpzZWxmOjpiYW5uZXIoaG9zdCx2ZXIpOwpzZWxmOjpiYWxhbmNlKCR1YSk7CnNlbGY6OmNsYWltKCR1YSk7CiAgc2VsZjo6ZygpOwpzZWxmOjptZW51KDEsIiBCeXBhc3MgRmF1Y2V0Iik7CnNlbGY6Om1lbnUoMiwiIEJ5cGFzcyBQdGMiKTsKJG1lbnU9cmVhZGxpbmUoc2VsZjo6Y29sKHN0cnRvdXBwZXIoInBpbGloOiIpLCJtcCIpICk7c2VsZjo6ZygpOwpzd2l0Y2ggKCRtZW51KSB7CmNhc2UgMTpzZWxmOjpmYXVjZXQoKTsKY2FzZSAyOnNlbGY6OnB0YygpOwp9fX0KKG5ldyBib3QpOw=="}}
